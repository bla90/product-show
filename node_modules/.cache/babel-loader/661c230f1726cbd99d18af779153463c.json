{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\neevs\\\\OneDrive\\\\Desktop\\\\product-show\\\\src\\\\components\\\\PostPage.jsx\";\nimport React, { Component } from \"react\";\nimport './css/style.css';\nimport Post from \"./Post\";\nimport Comments from \"./Comments\";\nimport { firestore } from \"../firebase\";\nimport { collectIdsAndDocs } from \"../utilities\";\nimport { withRouter } from \"react-router-dom\";\nimport withUser from \"./withUser\";\n\nclass PostPage extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      post: null,\n      comments: []\n    };\n    this.unsubscribeFromPost = null;\n    this.unsubscribeFromComments = null;\n\n    this.componentDidMount = async () => {\n      this.unsubscribeFromPost = this.postRef.onSnapshot(snapshot => {\n        const post = collectIdsAndDocs(snapshot);\n        this.setState({\n          post\n        });\n      });\n      this.unsubscribeFromComments = this.commentsRef.onSnapshot(snapshot => {\n        const comments = snapshot.docs.map(collectIdsAndDocs);\n        this.setState({\n          comments\n        });\n      });\n    };\n\n    this.componentWillUnmount = () => {\n      this.unsubscribeFromPost();\n      this.unsubscribeFromComments();\n    };\n\n    this.createComment = comment => {\n      this.postRef.update({\n        comments: this.state.comments.length + 1\n      });\n      const {\n        user\n      } = this.props;\n      this.commentsRef.add({ ...comment,\n        user\n      });\n    };\n  }\n\n  get postId() {\n    return this.props.match.params.id;\n  }\n\n  get postRef() {\n    return firestore.doc(`posts/${this.postId}`);\n  }\n\n  get commentsRef() {\n    return this.postRef.collection(\"comments\");\n  }\n\n  render() {\n    const {\n      post,\n      comments\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"section\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 7\n      }\n    }, post && /*#__PURE__*/React.createElement(Post, Object.assign({}, post, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 18\n      }\n    })), /*#__PURE__*/React.createElement(Comments, {\n      comments: comments,\n      onCreate: this.createComment,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 9\n      }\n    }));\n  }\n\n}\n\nexport default withRouter(withUser(PostPage));","map":{"version":3,"sources":["C:/Users/neevs/OneDrive/Desktop/product-show/src/components/PostPage.jsx"],"names":["React","Component","Post","Comments","firestore","collectIdsAndDocs","withRouter","withUser","PostPage","state","post","comments","unsubscribeFromPost","unsubscribeFromComments","componentDidMount","postRef","onSnapshot","snapshot","setState","commentsRef","docs","map","componentWillUnmount","createComment","comment","update","length","user","props","add","postId","match","params","id","doc","collection","render"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAO,iBAAP;AACA,OAAOC,IAAP,MAAiB,QAAjB;AACA,OAAOC,QAAP,MAAqB,YAArB;AACA,SAASC,SAAT,QAA0B,aAA1B;AACA,SAASC,iBAAT,QAAkC,cAAlC;AACA,SAASC,UAAT,QAA2B,kBAA3B;AAEA,OAAOC,QAAP,MAAqB,YAArB;;AAEA,MAAMC,QAAN,SAAuBP,SAAvB,CAAiC;AAAA;AAAA;AAAA,SAC/BQ,KAD+B,GACvB;AAAEC,MAAAA,IAAI,EAAE,IAAR;AAAcC,MAAAA,QAAQ,EAAE;AAAxB,KADuB;AAAA,SAe/BC,mBAf+B,GAeT,IAfS;AAAA,SAgB/BC,uBAhB+B,GAgBL,IAhBK;;AAAA,SAkB/BC,iBAlB+B,GAkBX,YAAY;AAC9B,WAAKF,mBAAL,GAA2B,KAAKG,OAAL,CAAaC,UAAb,CAAyBC,QAAD,IAAc;AAC/D,cAAMP,IAAI,GAAGL,iBAAiB,CAACY,QAAD,CAA9B;AACA,aAAKC,QAAL,CAAc;AAAER,UAAAA;AAAF,SAAd;AACD,OAH0B,CAA3B;AAKA,WAAKG,uBAAL,GAA+B,KAAKM,WAAL,CAAiBH,UAAjB,CAA6BC,QAAD,IAAc;AACvE,cAAMN,QAAQ,GAAGM,QAAQ,CAACG,IAAT,CAAcC,GAAd,CAAkBhB,iBAAlB,CAAjB;AACA,aAAKa,QAAL,CAAc;AAAEP,UAAAA;AAAF,SAAd;AACD,OAH8B,CAA/B;AAID,KA5B8B;;AAAA,SA8B/BW,oBA9B+B,GA8BR,MAAM;AAC3B,WAAKV,mBAAL;AACA,WAAKC,uBAAL;AACD,KAjC8B;;AAAA,SAmC/BU,aAnC+B,GAmCdC,OAAD,IAAa;AAC3B,WAAKT,OAAL,CAAaU,MAAb,CAAoB;AAAEd,QAAAA,QAAQ,EAAE,KAAKF,KAAL,CAAWE,QAAX,CAAoBe,MAApB,GAA6B;AAAzC,OAApB;AACA,YAAM;AAAEC,QAAAA;AAAF,UAAW,KAAKC,KAAtB;AACA,WAAKT,WAAL,CAAiBU,GAAjB,CAAqB,EACnB,GAAGL,OADgB;AAEnBG,QAAAA;AAFmB,OAArB;AAID,KA1C8B;AAAA;;AAG/B,MAAIG,MAAJ,GAAa;AACX,WAAO,KAAKF,KAAL,CAAWG,KAAX,CAAiBC,MAAjB,CAAwBC,EAA/B;AACD;;AAED,MAAIlB,OAAJ,GAAc;AACZ,WAAOX,SAAS,CAAC8B,GAAV,CAAe,SAAQ,KAAKJ,MAAO,EAAnC,CAAP;AACD;;AAED,MAAIX,WAAJ,GAAkB;AAChB,WAAO,KAAKJ,OAAL,CAAaoB,UAAb,CAAwB,UAAxB,CAAP;AACD;;AA+BDC,EAAAA,MAAM,GAAG;AACP,UAAM;AAAE1B,MAAAA,IAAF;AAAQC,MAAAA;AAAR,QAAqB,KAAKF,KAAhC;AACA,wBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGC,IAAI,iBAAI,oBAAC,IAAD,oBAAUA,IAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OADX,eAEE,oBAAC,QAAD;AAAU,MAAA,QAAQ,EAAEC,QAApB;AAA8B,MAAA,QAAQ,EAAE,KAAKY,aAA7C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,CADF;AAMD;;AApD8B;;AAuDjC,eAAejB,UAAU,CAACC,QAAQ,CAACC,QAAD,CAAT,CAAzB","sourcesContent":["import React, { Component } from \"react\";\r\nimport './css/style.css';\r\nimport Post from \"./Post\";\r\nimport Comments from \"./Comments\";\r\nimport { firestore } from \"../firebase\";\r\nimport { collectIdsAndDocs } from \"../utilities\";\r\nimport { withRouter } from \"react-router-dom\";\r\n\r\nimport withUser from \"./withUser\";\r\n\r\nclass PostPage extends Component {\r\n  state = { post: null, comments: [] };\r\n\r\n  get postId() {\r\n    return this.props.match.params.id;\r\n  }\r\n\r\n  get postRef() {\r\n    return firestore.doc(`posts/${this.postId}`);\r\n  }\r\n\r\n  get commentsRef() {\r\n    return this.postRef.collection(\"comments\");\r\n  }\r\n\r\n  unsubscribeFromPost = null;\r\n  unsubscribeFromComments = null;\r\n\r\n  componentDidMount = async () => {\r\n    this.unsubscribeFromPost = this.postRef.onSnapshot((snapshot) => {\r\n      const post = collectIdsAndDocs(snapshot);\r\n      this.setState({ post });\r\n    });\r\n\r\n    this.unsubscribeFromComments = this.commentsRef.onSnapshot((snapshot) => {\r\n      const comments = snapshot.docs.map(collectIdsAndDocs);\r\n      this.setState({ comments });\r\n    });\r\n  };\r\n\r\n  componentWillUnmount = () => {\r\n    this.unsubscribeFromPost();\r\n    this.unsubscribeFromComments();\r\n  };\r\n\r\n  createComment = (comment) => {\r\n    this.postRef.update({ comments: this.state.comments.length + 1 });\r\n    const { user } = this.props;\r\n    this.commentsRef.add({\r\n      ...comment,\r\n      user,\r\n    });\r\n  };\r\n\r\n  render() {\r\n    const { post, comments } = this.state;\r\n    return (\r\n      <section>\r\n        {post && <Post {...post} />}\r\n        <Comments comments={comments} onCreate={this.createComment} />\r\n      </section>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(withUser(PostPage));\r\n"]},"metadata":{},"sourceType":"module"}